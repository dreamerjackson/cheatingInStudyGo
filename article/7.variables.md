# 变量与类型
变量是存储数据的抽象概念。变量可以理解为执行环境中的数据存储区域，其内部存储了值，并可以根据变量的类型对值进行解析。

在《如何学习Go语言》中，我们介绍了如何从抽象的角度，将变量理解为不同大小和不同类型的瓶子来理解变量的定义。可以看到变量主要包含了两个重要的方面：
* 变量大小
 为变量分配的大小
* 变量类型
 如何对变量中的值进行解析，即便变量中存储了相同的值，可能解析出不同的结果

### 内置类型
在Go语言中，对于拥有内置数据类型的变量，在编译时即固定了分配的类型和相应的大小。例如int64代表存储的数据是整数，并且拥有64个字节的大小。像字符串这样的类型，以及切片、哈希表这样的类型要相对特殊一些。
```
int  int8  int16  int32  int64
uint  uint8  uint16  uint32  uint64  uintptr
float32  float64  complex128  complex64
bool  byte  rune  string
```

不管变量类型如何特殊，一旦在编译时定义好了之后，就无法变化。例如我们可以将之前的HelloWorld程序改写如下,其中s为声明的变量名，string为变量的类型，"Hello World"为初始化赋值到变量中的字符串值。
```
func main() {
	var s string = "Hello World"
	fmt.Println(s)
}

```

如果如下所示，我们尝试将变量s 赋值为整数，则直接在编译时报错。
```
func main() {
	var s string = "Hello World"
	s = 123
	fmt.Println(s)
}
```

报错为：
```
# command-line-arguments
./variables.go:8:4: cannot use 123 (type untyped int) as type string in assignment
```

## 强类型与弱类型
这种在确定了变量的类型之后，无法轻易修改变量类型的特性，叫做强类型。强类型的语言包括CC++、java、Go。 而动态类型的语言包括js、Ruby、python。
例如在js中，如下的语法是正常的:

```
var number = "string"
number = 1123
```

弱类型的语言虽然带来了灵活性，但是常常会实行隐式转换，或者产生难以意料的结果。例如js中，下例中产生的结果为字符串'12'，但是在强类型语言中直接会报错。
```
number = 1 + "2"
```

## 变量的声明与赋值
声明变量时需要定义一个名字，例如上例中的变量名s。变量名可以引用任何复杂的值、表达式和函数。一个短小和有意义的名字可以增加程序的可读性，并且是增加抽象，构建复杂程序的基础。

### var
第一种声明变量的方式是通过 `var` 指定变量名、类型、并分配初始值。其一般形式如下:
```
 var name type = expression
```

当不需要赋初始值时，`= expression` 可以被忽略。但是变量会被赋一个初始值。例如对于bool类型初始值为false、strings类型初始值为"", 接口和初始值类型为nil。如下所示，打印出空字符串。
```
var s string
fmt.Println(s) // ""
```

当 `type` 类型被忽略时，变量的类型取决于其赋值的表达式的类型。通过自动类型推断(参考《Go语言底层原理剖析》)的方式，为变量赋值。number 的类型为常量123的类型 int。
```
var number = 123
fmt.Println(number)
```

可以在单个声明语句中声明一系列变量。
```
var i, j, k int                 // int, int, int
var b, f, s = true, 2.3, "four" // bool, float64, string
```

初始化变量的值可以是整数、字符串，甚至是任何表达式，例如下例中，变量根据函数的返回值进行初始化。
```
var f, err = os.Open(name) // os.Open 返回文件结构体 和错误。
```

### :=

在函数中，有一种更简洁的变量声明方式，其形式为`name := expression`，变量name的类型由表达式确定，仍然是一种编译时类型自动推断的方式。如下所示：
```
anim := gif.GIF{LoopCount: nframes}
freq := rand.Float64() * 3.0
t := 0.0
```

可以通过如下方式打印出变量的类型：
```
	a := 10
	b := "zjx"
	c := 3.1415926
	d := true
	fmt.Printf("%T\n", a) // int
	fmt.Printf("%T\n", b) // string
	fmt.Printf("%T\n", c) // float64
	fmt.Printf("%T\n", d) // bool
```

由于`:=`声明方式的灵活性和简洁性，因此使用的最多。`var`声明常常用在需要强制声明变量类型，或者一开始并没有为变量赋初始化的情况。
```
i := 100                  // an int
var boiling float64 = 100 // a float64

var names []string
var err error
var p Point
```

声明只能发生一次。下例是一种特殊情况，第一个语句初始化了变量in和err，第二个语句只初始化了变量out。 而err是对变量的赋值
```
in, err := os.Open(infile)
// ...
out, err := os.Create(outfile)
```